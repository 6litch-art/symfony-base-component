{# @var ea \EasyCorp\Bundle\EasyAdminBundle\Context\AdminContext #}
{% trans_default_domain ea.i18n.translationDomain %}

{% set _content_title = block('content_title') ?? null %}
{% if _content_title is empty %}
    {% set _content_title = ea_extra.title(ea.crud.getCurrentPage() ?? null)|default("Dashboard") %}
{% endif %}

<!DOCTYPE html>
<html lang="{{ ea.i18n.htmlLocale }}" dir="{{ ea.i18n.textDirection }}">
<head>
    {% block head_metas %}
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="robots" content="noindex, nofollow, noarchive, nosnippet, noodp, noimageindex, notranslate, nocache" />
        <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
        <meta name="generator" content="EasyAdmin" />
    {% endblock head_metas %}

    <title>{% block page_title %}{{ _content_title|striptags|raw }}{% endblock %}</title>

    {% block head_stylesheets %}
        <link rel="stylesheet" href="{{ asset('bundles/easyadmin/app.css') }}">
        
        {% block configured_stylesheets %}
            {{ include('@EasyAdmin/includes/_css_assets.html.twig', { assets: ea.assets.cssAssets ?? [] }, with_context = false) }}
            {{ include('@EasyAdmin/includes/_encore_link_tags.html.twig', { assets: ea.assets.webpackEncoreAssets ?? [] }, with_context = false) }}
        {% endblock %}

        {% block head_favicon %}
            <link rel="shortcut icon" href="{{ asset(ea.dashboardFaviconPath) }}">
        {% endblock %}

        {% block head_javascript %}
            <script src="{{ asset('bundles/easyadmin/app.js') }}"></script>
        {% endblock head_javascript %}

        {% block configured_javascripts %}
            {{ include('@EasyAdmin/includes/_js_assets.html.twig', { assets: ea.assets.jsAssets ?? [] }, with_context = false) }}
            {{ include('@EasyAdmin/includes/_encore_script_tags.html.twig', { assets: ea.assets.webpackEncoreAssets ?? [] }, with_context = false) }}
        {% endblock %}

        {% if 'rtl' == ea.i18n.textDirection %}
            <link rel="stylesheet" href="{{ asset('bundles/easyadmin/app.rtl.css') }}">
        {% endif %}

        {% block configured_head_contents %}
            {% for htmlContent in ea.assets.headContents ?? [] %}
                {{ htmlContent|raw }}
            {% endfor %}
        {% endblock %}

            <style>

                {# #widget_list > div { margin-bottom:1.5em !important; } #}
                .row>* { padding-left:0 !important;}

                .d-inline .dropdown:after { margin-left:0px; }
                .d-inline .dropdown-toggle { background-color:transparent !important; margin-right:1px !important; }
                .d-inline .dropdown-toggle:active, .d-inline .dropdown-toggle:focus, .d-inline .dropdown-toggle.show {
                    border-color: transparent !important;
                    box-shadow: none !important;
                    outline: none !important;
                }

                @media (max-width: 992px)
                {
                    .text-center { text-align:left !important; }
                    .text-right { text-align:left !important; }
                }

                .navbar-custom-menu {
                    display:flex !important;
                }
                .dropdown-menu { min-width: 200px;}
                .dropdown-item.label-group:hover { background-color: transparent;  }
                .dropdown-item.label-group
                {
                    align-items: flex-start;
                    color: var(--sidebar-menu-header-color);
                    display: flex;
                    font-size: 12px;
                    font-weight: 500;
                    line-height: 15px;
                    margin-top: 15px;
                    padding: 0.25em !important;
                    text-transform: uppercase;
                }

                .actions .dropdown-toggle .action-icon { top: 2px !important; }
                .actions .dropdown-menu .action-icon { top: 0 !important; font-size:13pt !important; }
                .d-inline .dropdown-menu-end { margin-right: 45px !important; }
                .d-inline .dropdown-menu { margin-top: 10px !important; }
                .d-inline .dropdown-menu
                {
                    transform:translate3d(39px, 10px, 0px);
                }

                .locale-dropdown .dropdown-toggle i
                {
                    margin:0;
                }

                .locale-dropdown .dropdown-toggle
                {
                    font-size:18pt;
                    margin:0 !important;
                    border:none !important;
                    background:none !important;
                    box-shadow:none !important;
                }

                .dropdown .actions .action-icon { top: 0 !important;}
                .d-inline .dropdown-toggle:not(root-allowed):after 
                {
                    margin:auto 5px auto auto !important;
                    background-color:transparent;
                }

                .datagrid .lightbox-association img { filter: blur(2px); }
                .datagrid .lightbox-association:hover img { filter: blur(0px); }
                .datagrid .lightbox-association:hover span { visibility:hidden; }
                .datagrid .lightbox-association span 
                { 
                    font-weight: bold;
                    position: absolute;
                    color: var(--gray-600); 
                }
                .hide { visibility:hidden; }

                .content-header-icon a { color: var(--sidebar-logo-color); }
                .content-header-icon a:hover { color: var(--sidebar-menu-color); }
                .content-header-title .title i { vertical-align:top; }
                .content-header-title .title a { color: var(--sidebar-logo-color); }
                .content-header-title .title a:hover { color: var(--sidebar-menu-color); }
                .content-header-title .title a.impersonate { color: var(--link-color); text-decoration: var(--link-decoration); } 
                .content-header-title .title a.impersonate:hover { color: var(--link-hover-color); text-decoration: var(--link-hover-decoration); } 
                
                .content-header-title span { color: var(--sidebar-menu-icon-color); }
                
                .menu-item-label {
                    position:relative;
                    top:2px;
                }
                .ea-sidebar-width-compact #header-logo { visibility:hidden; }
                .ea-sidebar-width-compact .navbar { display:none; }
                .ea-sidebar-width-compact .main-header { padding-top:7em; }
                .custom-file { max-width: 355px; }
                .custom-file-label { margin-top: 0 !important; text-align: left !important; }

                .form-group.field-collection.form-control > div:nth-last-child(-n+2) .accordion-item { border-bottom: 0px solid lightgrey; }
                .form-select2 { margin-bottom: 0em !important; }
                .form-errors { margin: 1em 0.5em !important;}
                .ea .form-group { padding:1em 0em !important; }
                .ea-edit-form > .form-group, .ea-new-form > .form-group  { padding: 1em 0.5em !important; }
                .ea-edit-form > .form-translatable.form-group, .ea-new-form > .form-translatable.form-group  { padding: 0em 0.5em !important; }

                #filters { padding: .5em !important; }
                .form-translatable .tab-pane > div:first-child { padding: 0.5em 0 0 0 !important; }
                .form-translatable .tab-pane > div { padding-bottom: 0em !important; }
                .form-translatable .tab-pane > div:last-child { padding-bottom: 1.5em !important; }
                .form-entity > div { margin-bottom: 0em !important; }

                .content-top { height:90px; }
                
                .form-switch {
                    padding:12px 0;
                    margin:0;
                }

                .content-header {
                    padding: 1em 2.5em 2em 2.5em !important;
                }
                
                .datalist dd, .datalist dt {
                    display:flex;
                    align-items: center;
                }

                .field-impersonate { 
                    font-size:14pt;
                }

                span[data-toggle="tooltip"]
                {
                    position: relative;
                    top: 1px;
                }

                .basicLightbox img { max-height: 90vh !important; } 
                .field-email-icon {

                    background-color: var(--gray-200);
                    color: var(--gray-600);
                    border-radius:100%;
                    font-size:14pt;
                    width:14pt;
                    padding:0.15em;
                    margin:0.15em;
                    margin-left:0;
                }

                .dropdown-toggle { margin:auto !important; }
                .dropdown-toggle:focus { box-shadow: var(--button-shadow) !important; }

                .dropdown-toggle { margin:auto !important; }
                .dropdown-toggle:after { margin:auto !important; }
                .dropdown-toggle:after:not(.root-allowed) { margin:auto 0 auto 0.5em !important; }
                .dropdown-toggle:not(.root-allowed):after { margin:auto 0 auto 0.5em !important; }
                .dropdown-menu li a {

                    padding: 2px 5px;
                    text-align: left;
                    width: 100%;
                    height: 100%;
                }

                .dropdown-menu li { padding:0 !important; }
                .dropdown-menu
                {
                    margin:0.75em 0 !important;
                    padding:0.5em;
                }

                .dropdown-menu
                {
                    top:0;
                    margin-top: 15px !important;

                    opacity:0;
                    transition: opacity 0.5s;
                }

                .input-group-text { padding: .375rem .75rem !important; }

                .dropdown-menu.show, .dropdown-menu.bootstrap-datetimepicker-widget {

                    transition: all 500ms, opacity 0.5s;
                    transform-origin:top;
                    opacity:1;
                }

                .badge { padding:0.4em 0.5em; }

                .badge .label:first-child { margin-right:0.15em; padding-right:0.5em; border-right:1.5px solid; }
                .badge .label:last-child  { margin-left:0.15em; padding-left:0.5em; border-left:1.5px solid; }
                .badge i {  font-size:10pt;            }
                .badge > * {
                    display:flex;
                    align-items: center;
                    justify-content: center;
                    font-size:9pt;            
                }

                .nav-link {
                    position: relative;
                    bottom: -1px;
                }

                .form-switch .form-check-label
                {
                    padding:0;
                    margin:0;
                }

                .form-group label.form-check-label.required:after {
                    content: "â€¢";
                }

                .field-icon i  
                {
                    text-shadow: var(--white) 1px 0 5px !important;
                }

                body.ea-edit .content-header, body.ea-new .content-header {
                    top: 0px;
                    padding: 1em 2.5em 1em 2.5em !important;
                    background-color:white;
                }

                .content-wrapper { padding:0; }

                .content-body {
                    padding: 0 var(--lg-content-padding-right) 5em var(--lg-content-padding-left);
                }

                .content-body .ea-edit-form, .content-body .ea-new-form
                {
                    margin:auto;
                    width:95%;
                }

                .form-translatable .tab-pane > div { margin-bottom: 0.5em; }
                .alert {

                    display:flex;
                    flex-direction:column;
                    padding-left: 3em;
                }
                
                .alert .btn-close {

                    position: absolute;
                    left: 1em;

                    font-size: 8pt;
                    margin-top: 0.4em;
                    margin-left: 0.2em;
                }
                
                .modal .btn-close 
                {
                    font-size: 20pt;
                    margin-left: -0.5em;
                    border: 0;
                    background: transparent;
                }
                .alert p {
                    
                    margin-left:1em;
                    margin-bottom:0;
                }

                .content-body .flex-fill {
                    display:none;
                }
                
                #navigation-toggler { 
                    margin: 0.4em 0.725em;
                }

                #header-logo .spacer
                {
                    height:125px;
                }

                .content-wrapper { margin-top:2.5em !important; }

                .user-menu-wrapper 
                { 
                    display:flex;
                    align-items: center;
                    justify-content: center;

                    margin:0.25em !important;
                }

                .user-menu-wrapper .user-details .user-name { margin-left: 15px; }

                .user-avatar, .thumbnail-avatar { border-radius:50% !important; }
                .thumbnail-image { border-radius:5% !important; }
                .img-fluid
                {
                    display:flex;
                    align-items:center;
                    justify-content:center;

                    object-fit:cover;
                }

                .datagrid tr:hover .lightbox-thumbnail image { border-color:transparent !important; }
                .ea-detail .lightbox-thumbnail img, .datagrid .lightbox-thumbnail img {
                    max-height: 105%;
                    max-width: unset;
                    padding: 0;
                }

                .ea-extra-image
                {
                    display: flex !important;
                    align-items: center;
                    justify-content: center;
                    max-height: 105%;
                    max-width: unset;
                    padding: 0;
                }

                .actions .action-icon 
                {
                    font-size:14pt !important;
                    top:5px;
                    position:relative;
                    padding-bottom:10px;
                }

                .user-menu-wrapper .user-avatar {

                    display: flex !important;
                    align-items: center;
                    justify-content: center;
                    width:50px !important;
                    height:50px !important;
                }

                .user-avatar, .ea-index .thumbnail-avatar, .ea-index .thumbnail-image {

                    overflow:hidden;
                    box-shadow: 0 0 0 2px var(--white),0 0 4px 1px var(--gray-600) !important;
                    margin: 10px auto !important;
                    
                    max-height: 50px !important;
                    height: 50px !important;
                    max-width: 50px !important;
                    width: 50px !important;
                }

                .ea-detail .thumbnail-avatar, .ea-detail .thumbnail-image {

                    overflow:hidden;
                    box-shadow: 0 0 0 2px var(--white),0 0 4px 1px var(--gray-600) !important;
                    margin: 10px 5px !important;
                    
                    max-height: 250px !important;
                    height: 250px !important;
                    max-width: 250px !important;
                    width: 250px !important;
                }

                .ea-detail .user-avatar i, .ea-detail .thumbnail-avatar i, .ea-detail .thumbnail-image i { font-size:150pt; }

                #header-logo 
                {
                    margin-top:20px;
                }

                .list-pagination 
                {
                    padding:0 !important;
                }
                
                #navitation-toggler img {
                    margin-top: 4px;
                }
                
                .responsive-header .dropdown
                {
                    padding: 0 !important;
                }
                
                .dropdown-item a { text-align:center; }
                .dropdown i, .action-index i, .action-edit i, .action-new i 
                {
                    margin:0.25em 0.25em 0.25em 0;
                }

                .responsive-menu { padding:1.25em; }
                .logo, .responsive-logo {
                    
                    border-radius:50% !important;
                    box-shadow: 0 0 0 5px var(--white),0 0 8px 2px var(--gray-600) !important;

                    margin:1em auto !important;
                    max-height: 150px !important;
                    height: 150px !important;
                    max-width: 150px !important;
                    width: 150px !important;

                    overflow:hidden;

                }

                ul.sidebar-menu {
                    list-style:none;
                }

                .content-header-icon {
                    background-color:var(--fieldset-bg);
                    border: var(--border-width) var(--border-style) var(--border-color);
                    border-radius:100%;

                    margin:0 0.5em;
                    height:70px;
                    width:70px;
                    display:flex;
                    align-items:center;
                    justify-content:center;

                    overflow:hidden;
                }

                .content-header {
                    display:flex;
                    flex-direction:row;
                    justify-content:center;
                    align-items:center;
                }
                .content-header-title .title {
                    color: var(--sidebar-logo-color);
                }

                .field-impersonate { margin:0.1em;}
                fieldset .sidebar-menu {
                
                    margin:0.25em 0em 0.25em 0 !important;
                }
                fieldset {
                    padding:1em 0.5em 0.5em 1em!important;
                }
                
                .content-panel
                {
                    height:100% !important;
                    margin: 0 !important;
                    padding: 0em 0em 1.6em 0.6em !important;
                }

                .main-header #header-logo a {
                    padding:unset
                }
                
                .main-header #header-logo .logo-custom {
                    height: 100%;
                    width: 100%;

                    display:flex !important;
                    justify-content : space-between;
                    align-content   : center;
                }

                .logo-custom img
                {
                    margin-left: auto;
                    margin-right: auto;
                    object-fit:cover;
                    display: block;
                }

                #navigation-toggler { 
                    width: 100% ! important;
                    height: 100% !important;
                    margin: auto;
                }

                .responsive-logo img
                {
                    width: 100%;
                    margin-left: auto;
                    margin-right: auto;
                    object-fit:cover;
                    display: block;
                }
                
                .content-panel-body.with-background,
                .content-panel-body.without-footer, .content-panel-footer
                {
                    padding: 1em 3em !important;
                    background: var(--fieldset-bg);
                    border: var(--border-width) var(--border-style) var(--border-color);
                    border-radius: var(--border-radius);                
                }
                fieldset .sidebar-menu li {
                
                    padding:0.25em 0em 0.25em 0!important;
                }

                ul.sidebar-menu a {
                    color: var(--sidebar-menu-color);
                }
                
                .field-avatar .image-avatar i, img.image-avatar
                {
                    border-radius: 50%;
                    overflow:hidden;
                }

                .user-menu hr {
                    display:none;
                }

                .user-menu-wrapper 
                {
                    padding:0 1em;
                    background: var(--fieldset-bg);
                    border: var(--border-width) var(--border-style) var(--border-color);
                    border-radius: 1em;
                }

                .responsive-header .user-menu-wrapper 
                {
                    padding-right:1em;
                    background: transparent;
                    border: 0;
                    border-radius: 1em;
                }

                {# .content-panel-body.without-footer, .content-panel-footer { border: none; } #}
                .content-panel-footer { border: var(--border-width) var(--border-style) var(--border-color) !important; }

                @media (min-width: 992px) {
                    .content-header { 
                        background: transparent;
                    }
                }
        </style>
    {% endblock %}
    
</head>

{% block body %}
    <body id="{% block body_id %}{% endblock %}" class="ea {% block body_class %}{% endblock %}">
    {% block javascript_page_layout %}
        <script>
            document.body.classList.add(
                'ea-content-width-' + (localStorage.getItem('ea/content/width') || '{{ ea.crud.contentWidth ?? ea.dashboardContentWidth ?? 'normal' }}'),
                'ea-sidebar-width-' + (localStorage.getItem('ea/sidebar/width') || '{{ ea.crud.sidebarWidth ?? ea.dashboardSidebarWidth ?? 'normal' }}')
            );
        </script>
    {% endblock javascript_page_layout %}

    {% block wrapper_wrapper %}
        {% block flash_messages %}
            {{ include(ea.templatePath('flash_messages')) }}
        {% endblock flash_messages %}

        {% set user_menu_avatar %}
            {% if null == ea.userMenu.avatarUrl %}
                <i class="fa fa-3x fa-fw {{ ea.user is not null ? 'fa-user-circle' : 'fa-user-times' }} user-avatar"></i>
            {% else %}
                <img class="user-avatar" src="{{ ea.userMenu.avatarUrl|thumbnail(200,200) }}" />
            {% endif %}
        {% endset %}

        {% set impersonator_permission = constant('Symfony\\Component\\Security\\Core\\Authorization\\Voter\\AuthenticatedVoter::IS_IMPERSONATOR') is defined ? 'IS_IMPERSONATOR' : 'ROLE_PREVIOUS_ADMIN' %}

        {% set user_menu_dropdown %}
            <ul class="dropdown-menu dropdown-menu-end">
                {# <li class="dropdown-user-details">
                    <div>{{ user_menu_avatar }}</div>
                    <div>
                        <span class="user-label">{{ 'user.logged_in_as'|trans(domain = 'EasyAdminBundle') }}</span>
                        <span class="user-name">{{ ea.user is null ? 'user.anonymous'|trans(domain = 'EasyAdminBundle') : ea.userMenu.name }}</span>
                    </div>
                </li>
                <li><hr class="dropdown-divider"></li> #}

                {% block user_menu %}
                    {% if ea.userMenu.items|length > 0 %}
                        {% for item in ea.userMenu.items %}
                            <li>
                                {% if item.isMenuSection and not loop.first %}
                                    <hr class="dropdown-divider">
                                {% elseif not item.isMenuSection %}
                                    <a href="{{ item.linkUrl }}" class="dropdown-item user-action {{ item.cssClass }}"
                                       target="{{ item.linkTarget }}" rel="{{ item.linkRel }}"
                                       referrerpolicy="origin-when-cross-origin">
                                        {% if item.icon is not empty %}<i class="fa fa-fw {{ item.icon }}"></i>{% endif %}
                                        <span>{{ item.label }}</span>
                                    </a>
                                {% endif %}
                            </li>
                        {% endfor %}
                    {% endif %}
                {% endblock user_menu %}
            </ul>
        {% endset %}

        <div class="wrapper">
            {% block wrapper %}
                <div class="responsive-header">
                    {% block responsive_header %}
                        
                        <div class="responsive-menu">
                            <button id="navigation-toggler" type="button" aria-label="Toggle navigation">
                                <i class="fa fa-2x fa-bars"></i>
                            </button>
                        </div>

                        <div id="responsive-header-logo" class="text-truncate">
                            {% block responsive_header_logo %}
                                <div class="responsive-logo">
                                    <a title="{{ ea.dashboardTitle|striptags }}" href="{{ path(ea.dashboardRouteName) }}">
                                    {{ ea.dashboardTitle|raw }}
                                    </a>
                                </div>
                            {% endblock responsive_header_logo %}
                        </div>

                        <div class="dropdown user-menu-wrapper {{ is_granted(impersonator_permission) ? 'user-is-impersonated' }}">
                            <a class="user-details" type="button" data-bs-toggle="dropdown" data-bs-offset="0,5" aria-expanded="false">
                                {# to make the site design consistent, always display the user avatar in responsive header
                                   and hide the user name (because there's no space left) regardless of the user config #}
                                {% if ea.userMenu.avatarDisplayed %}
                                    {{ user_menu_avatar }}
                                {% else %}
                                    <i class="user-avatar fa fa-fw {{ ea.user is not null ? 'fa-user' : 'fa-user-times' }}"></i>
                                {% endif %}
                            </a>

                            {{ user_menu_dropdown }}
                        </div>
                    {% endblock responsive_header %}
                </div>

                <div class="sidebar-wrapper">
                    <aside class="sidebar">
                        {% block sidebar %}
                            <header class="main-header">
                                {% block header %}
                                <nav class="navbar" role="navigation">
                                    {% block header_navbar %}
                                        <div id="header-logo">
                                            {% block header_logo %}
                                                <a class="logo" title="{{ ea.dashboardTitle|striptags }}" href="{{ path(ea.dashboardRouteName) }}">
                                                    <div class="logo-custom">{{ ea.dashboardTitle|raw }}</div>
                                                    <span class="logo-compact"><i class="fas fa-home"></i></span>
                                                </a>
                                            {% endblock header_logo %}
                                        </div>
                                    {% endblock header_navbar %}
                                </nav>
                                {% endblock header %}
                            </header>

                            {% block main_menu_wrapper %}
                                {{ include(ea.templatePath('main_menu')) }}
                            {% endblock main_menu_wrapper %}
                        {% endblock sidebar %}

                        <div id="sidebar-resizer-handler" class="resizer-handler resizer-handler-left"></div>
                    </aside>
                </div>

                <section class="main-content">
                    {% set has_search = ea.crud is not null and ea.crud.isSearchEnabled %}
                    <aside class="content-top {{ has_search ? 'ea-search-enabled' : 'ea-search-disabled' }}">

                        {% block content_top_header %}
                            <div class="content-search">
                                {% if has_search %}
                                    {% block search %}

                                        <form class="form-action-search" method="get">
                                            {% block search_form %}
                                                <input type="hidden" name="crudAction" value="index">
                                                <input type="hidden" name="crudControllerFqcn" value="{{ ea.request.query.get('crudControllerFqcn') }}">
                                                <input type="hidden" name="menuIndex" value="{{ ea.request.query.get('menuIndex') }}">
                                                <input type="hidden" name="submenuIndex" value="{{ ea.request.query.get('submenuIndex') }}">
                                                <input type="hidden" name="page" value="1">
                                                <input type="hidden" name="signature" value="{{ ea_url().unsetAll().setAction('index').setController(ea.request.query.get('crudControllerFqcn')).getSignature() }}">

                                                <div class="form-group">
                                                    <div class="form-widget">
                                                        <i class="fas fa-search content-search-icon"></i>

                                                        <label class="content-search-label" data-value="{{ app.request.get('query') }}">
                                                            <input class="form-control {{ app.request.get('query') is null ? 'is-blank' }}" type="search" name="query" value="{{ app.request.get('query') ?? '' }}" placeholder="{{ 'action.search'|trans(ea.i18n.translationParameters, 'EasyAdminBundle') }}" spellcheck="false" autocorrect="false" onInput="this.parentNode.dataset.value=this.value">
                                                        </label>

                                                        {% if app.request.get('query') %}
                                                            <a href="{{ ea_url().unset('query') }}" class="content-search-reset">
                                                                <i class="fas fa-fw fa-times"></i>
                                                            </a>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                            {% endblock %}
                                        </form>
                                    {% endblock search %}
                                {% endif %}
                            </div>

                            <div class="navbar-custom-menu">
                                {% block header_custom_menu %}
                                <div class=" user-menu-wrapper {{ is_granted(impersonator_permission) ? 'user-is-impersonated' }}">
                                    <div class="dropdown">
                                        <a class="user-details" type="button" data-bs-toggle="dropdown" data-bs-offset="0,5" aria-expanded="false">
                                            {{ user_menu_avatar }}
                                            {% if ea.userMenu.isNameDisplayed %}
                                                <span class="user-name">{{ ea.userMenu.name }}</span>
                                            {% endif %}
                                        </a>

                                        {{ user_menu_dropdown }}
                                    </div>
                                </div>
                                {% endblock header_custom_menu %}
                                <div class=" user-menu-wrapper {{ is_granted(impersonator_permission) ? 'user-is-impersonated' }}">
                                    {{ render_locale("locale_changeto", {"class": "dropdown-menu-end"}, "@Base/locale/dropdown-min.html.twig") }} 
                                </div>
                            </div>
                        {% endblock content_top_header %}
                    </aside>

                    <div class="content-wrapper">
                        {% block content_wrapper %}
                        
                            <article class="content">
                            
                                    {% block content_header_wrapper %}
                                    
                                    <section class="content-header">
                                    
                                        {% block content_header %}

                                        <div class="content-header-icon">
                                        {% set url = ea.crud is not null and ea.crud.paginator.pageNumber != 1 ? ea_url().setController(ea.crud.controllerFqcn).setAction('index').generateUrl() : null %}
                                        
                                        {% set _content_icon = block('content_icon') ?? null %}
                                        {% if _content_icon is not empty %}
                                            {{ _content_icon|raw }}
                                        {% else %}
                                            {% set image = ea_extra.image(ea.crud.getCurrentPage() ?? null)|default(null) %}
                                            {% if image is not null %}
                                                <img class="ea-extra-image" src="{{ asset(image)|thumbnail(200,200) }}">
                                            {% else %}
                                                {% if url is not empty %}<a href="{{url}}">{% endif %}
                                                <i class="ea-extra-logo fa-fw fa-3x {{ ea_extra.icon(ea.crud.getCurrentPage() ?? null)|default("fas fa-icons") }}"></i>
                                                {% if url is not empty %}</a>{% endif %}
                                            {% endif %}
                                        {% endif %}

                                        </div>

                                        <div class="content-header-title">
                                            <h1 class="title">
                                            {% set url = ea.crud is not null and ea.crud.getCurrentPage() == "detail" ? ea_url().setController(ea.crud.controllerFqcn).setAction('index').generateUrl() : null %}
                                            {% set isHtml = _content_title != (_content_title|striptags) %}

                                            {% if url is not empty and not isHtml %}<a href="{{url}}">{% endif %}
                                                {{ _content_title|raw }}
                                            {% if url is not empty %}</a>{% endif %}

                                            {% set _content_help = block('content_help') ?? null %}
                                            {% if _content_help is not empty %}
                                                {{ _content_help|raw }}
                                            {% else %}
                                                {% set helpMessage = "" %}
                                                {% if ea.crud is not null %}
                                                    {% set helpMessage = ea.crud.helpMessage %}
                                                {% endif %}
                                                {% if helpMessage is empty %}
                                                    {% set helpMessage = ea_extra.help(ea.crud.getCurrentPage() ?? null) %}
                                                {% endif %}
                                                {% set has_help_message = (helpMessage is not empty) %}

                                                {% if has_help_message %}
                                                <span class="content-header-help">
                                                    <i class="far fa-question-circle" data-bs-toggle="tooltip" title="{{ helpMessage|e('html_attr') }}"></i>
                                                </span>
                                                {% endif %}
                                            {% endif %}
                                            </h1>

                                            {% set _content_text = block('content_text') ?? null %}
                                            {% if _content_text is not empty %}
                                                {{ _content_text|raw }}
                                            {% else %}
                                                <span>{{ ea_extra.text(ea.crud.getCurrentPage() ?? null)|raw }}</span>
                                            {% endif %}
                                        </div>

                                        {% block page_actions_wrapper %}
                                            <div class="page-actions">{% block page_actions %}{% endblock %}</div>
                                        {% endblock %}
                                        {% endblock content_header %}
                                    </section>
                                {% endblock content_header_wrapper %}

                                <section id="main" class="content-body">
                                {% block main %}

                                    {% set content = block('content') is defined ? block('content') : '' %}
                                    {% if content is not empty %}
                                    <div class="content-panel">
                                        <div class="content-panel-body with-background without-header without-footer">
                                            {{ content|raw }}
                                        </div>
                                    </div>
                                    {% else %}

                                    {% if ea_extra.widgets(ea.crud.getCurrentPage() ?? null) is defined and ea_extra.widgets(ea.crud.getCurrentPage() ?? null)|length > 0 %}
                                    <div class="row mx-0">
                                        {% set content_widget_closure = false %}
                                        {% for content_widget in ea_extra.widgets(ea.crud.getCurrentPage() ?? null)  %}

                                            {% if content_widget.getAsDto().getType() == "section" %}

                                                {% if content_widget_closure %}
                                                        </ul>
                                                    </fieldset>
                                                    </div>
                                                </div>

                                                {% endif %}

                                            {% set content_widget_closure = true %}
                                            {% set col = content_widget.getWidth() %}

                                                <div class="col-md-{{ 2*col }} p-0">
                                                <div class="content-panel m-md-1 with-background without-header without-footer"
                                                    style="height:90%; padding:0.8em 0.6em 0.6em 0.6em;">

                                                <fieldset style="height: 100%; margin:0; padding:0.5em 0 1.5em 0.5em;">
                                                    <legend>{{content_widget.getAsDto().getLabel()|trans|upper }}</legend>
                                                <hr>
                                                <ul class="sidebar-menu tree p-md-0 m-md-0" style="columns:{{col}};">

                                            {% else %}
                                                <li>
                                                    <a href="{{ content_widget.generateUrl() }}">
                                                        <i class="fa-fw {{ content_widget.getAsDto().getIcon() }}"></i>
                                                        {{ content_widget.getAsDto().getLabel()|trans|capitalize }}
                                                    </a>
                                                </li>
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                    {% endif %}

                                    {% endif %}

                                {% endblock %}
                                </section>

                                {% block content_footer_wrapper %}
                                    {% set content_footer = block('content_footer') is defined ? block('content_footer') : '' %}
                                    {% if content_footer is not empty %}
                                        <section class="content-footer">
                                            {{ content_footer }}
                                        </section>
                                    {% endif %}
                                {% endblock %}
                            </article>
                        {% endblock %}

                        <div id="content-resizer-handler" class="resizer-handler resizer-handler-right"></div>
                    </div>
                </section>
            {% endblock wrapper %}
        </div>
    {% endblock wrapper_wrapper %}

    {% block body_javascript %}{% endblock body_javascript %}
    <script> $(function () { $('[data-toggle="tooltip"]').tooltip() }); </script>
    <script> if(typeof lightbox !== 'undefined') lightbox.option({'resizeDuration': 500, 'fadeDuration': 250, 'imageFadeDuration': 100});</script>
    {% block configured_body_contents %}
        {% for htmlContent in ea.assets.bodyContents ?? [] %}
            {{ htmlContent|raw }}
        {% endfor %}
    {% endblock %}
    </body>
{% endblock body %}
</html>
